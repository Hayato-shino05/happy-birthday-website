<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎨 Theme Tester - お誕生日おめでとうウェブサイト</title>
    <link rel="stylesheet" href="assets/css/base.css">
    <link rel="stylesheet" href="assets/css/themes.css">
    <link rel="stylesheet" href="assets/css/components.css">
    <link rel="stylesheet" href="assets/css/mobile.css">
    <link rel="stylesheet" href="assets/css/page/community.css">
    <link rel="stylesheet" href="assets/css/page/core.css">
    <link rel="stylesheet" href="assets/css/page/features.css">
    <link rel="stylesheet" href="assets/css/page/album.css">
    <link rel="stylesheet" href="assets/css/page/themes.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    
<style>
    .social-share {
        display: flex;
        gap: 1rem;
        justify-content: center;
        margin: 1rem 0;
    }
    
    .share-button {
        border: none;
        background: #f0f0f0;
        padding: 0.8rem;
        border-radius: 50%;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .share-button:hover {
        transform: scale(1.1);
        background: #e0e0e0;
    }
    
    .fa-facebook-f {
        color: #1877f2;
    }
    
    .fa-x-twitter {
        color: #000000;
    }
    
    .fa-instagram {
        color: #e4405f;
    }
    
    .birthday-title {
        font-family: 'Dancing Script', cursive;
        font-size: 3.5em;
        color: #8B4513;
        text-shadow: 3px 3px 6px rgba(0,0,0,0.2);
        margin: 0;
        padding: 20px;
        animation: birthdayPop 1.5s ease-out;
    }
    
    .birthday-subtitle {
        font-family: 'Dancing Script', cursive;
        font-size: 2em;
        color: #FF1493;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.15);
        margin: 0;
        padding: 10px;
        animation: birthdayPop 1.8s ease-out;
    }
    
    @keyframes birthdayPop {
        0% { transform: scale(0); opacity: 0; }
        50% { transform: scale(1.2); }
        100% { transform: scale(1); opacity: 1; }
    }
    </style>
</head>
<body>
    <!-- テーマテスターパネル -->
    <div id="theme-tester" style="position: fixed; top: 20px; right: 20px; background: rgba(0, 0, 0, 0.9); border-radius: 15px; padding: 20px; z-index: 2000; max-height: 85vh; overflow-y: auto; min-width: 300px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1);">
        <h2 style="color: #fff; margin: 0 0 15px 0; font-size: 18px; text-align: center;">🎨 Theme Tester</h2>
        
        <div style="background: rgba(255, 255, 255, 0.1); padding: 10px; border-radius: 8px; margin-bottom: 15px; text-align: center;">
            <strong id="current-theme" style="color: #00ff88; font-size: 16px;">Current Theme</strong>
        </div>
        
        <div style="margin-bottom: 20px;">
            <h3 style="color: #ffd700; margin: 0 0 10px 0; font-size: 14px;">🌸 Seasons</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                <button onclick="testTheme('spring')" style="padding: 8px 12px; border: none; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: bold; color: white; background: linear-gradient(135deg, #ffb6c1, #ff69b4);">春 Spring</button>
                <button onclick="testTheme('summer')" style="padding: 8px 12px; border: none; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: bold; color: white; background: linear-gradient(135deg, #ffd700, #ff8c00);">夏 Summer</button>
                <button onclick="testTheme('autumn')" style="padding: 8px 12px; border: none; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: bold; color: white; background: linear-gradient(135deg, #d2691e, #8b4513);">秋 Autumn</button>
                <button onclick="testTheme('winter')" style="padding: 8px 12px; border: none; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: bold; color: white; background: linear-gradient(135deg, #87ceeb, #4682b4);">冬 Winter</button>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <h3 style="color: #ffd700; margin: 0 0 10px 0; font-size: 14px;">🎋 Japanese Festivals</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                <button onclick="testTheme('hanami')" style="padding: 8px 12px; border: none; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: bold; color: white; background: linear-gradient(135deg, #ffb6c1, #ff1493);">花見</button>
                <button onclick="testTheme('tanabata')" style="padding: 8px 12px; border: none; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: bold; color: white; background: linear-gradient(135deg, #9370db, #4b0082);">七夕</button>
                <button onclick="testTheme('obon')" style="padding: 8px 12px; border: none; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: bold; color: white; background: linear-gradient(135deg, #ff6347, #dc143c);">お盆</button>
                <button onclick="testTheme('tsukimi')" style="padding: 8px 12px; border: none; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: bold; color: white; background: linear-gradient(135deg, #f0e68c, #daa520);">月見</button>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <h3 style="color: #ffd700; margin: 0 0 10px 0; font-size: 14px;">🎉 International</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                <button onclick="testTheme('christmas')" style="padding: 8px 12px; border: none; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: bold; color: white; background: linear-gradient(135deg, #228b22, #dc143c);">🎄</button>
                <button onclick="testTheme('newyear')" style="padding: 8px 12px; border: none; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: bold; color: white; background: linear-gradient(135deg, #ffd700, #ff4500);">🎊</button>
                <button onclick="testTheme('valentine')" style="padding: 8px 12px; border: none; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: bold; color: white; background: linear-gradient(135deg, #ff69b4, #ff1493);">💕</button>
                <button onclick="testTheme('halloween')" style="padding: 8px 12px; border: none; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: bold; color: white; background: linear-gradient(135deg, #ff8c00, #8b0000);">🎃</button>
            </div>
        </div>
        
        <button onclick="clearAllEffects()" style="width: 100%; padding: 10px; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: bold; background: linear-gradient(135deg, #e17055, #d63031); color: white;">🧹 Clear Effects</button>
    </div>

    <!-- フォトアルバムボタン -->
    <button class="feature-button" id="openAlbum">
        📸 思い出アルバム
    </button>

    <!-- ゲームセクション -->
    <div class="games-container">
        <button class="game-button" id="startMemoryGame">🎮 神経衰弱</button>
        <button class="game-button" id="startPuzzleGame">🧩 パズル</button>
        <button id="openCalendar" class="game-button">📅 誕生日カレンダー</button>
        <button id="startBirthdayQuiz" class="game-button">❓ 誕生日クイズ</button>
    </div>

    <!-- 言語選択 -->
    <div class="language-selector">
        <select id="languageSelect">
            <option value="ja">日本語</option>
            <option value="en">English</option>
        </select>
    </div>

    <!-- メッセージボタン -->
    <div class="custom-message-container">
        <button class="feature-button" id="customMessageBtn">✍️ お祝いメッセージ</button>
        <button class="feature-button" id="bulletinBoardBtn">📋 お祝い掲示板</button>
    </div>

    <!-- 掲示板モーダル -->
    <div class="bulletin-board-modal" id="bulletinBoardModal">
        <div class="modal-content">
            <span class="close-btn" id="closeBulletinBoard">&times;</span>
            <h2>お誕生日お祝い掲示板</h2>
            <div class="bulletin-posts" id="bulletinPosts"></div>
            <div class="post-form">
                <button id="selectGiftBtn" class="gift-select-btn">🎁 バーチャルギフトを選ぶ</button>
                <div id="selectedGiftDisplay" style="display: none; margin-top: 10px; color: #854D27;"></div>
                <button id="submitPost">ギフトを送る</button>
            </div>
        </div>
    </div>

    <!-- バーチャルギフト選択モーダル -->
    <div class="virtual-gift-modal" id="virtualGiftModal">
        <div class="modal-content">
            <span class="close-btn" id="closeVirtualGift">&times;</span>
            <h2>バーチャルギフトを選択</h2>
            <div class="gift-list" id="giftList"></div>
            <input type="text" id="giftSender" placeholder="お名前..." style="width: 100%; padding: 10px; margin: 15px 0; border: 2px solid #D4B08C;">
            <button id="submitGift" style="padding: 10px 20px; background: #854D27; color: #FFF9F3; border: 2px solid #D4B08C; cursor: pointer; font-size: 1.1em;">ギフトを送る</button>
        </div>
    </div>

    <!-- メッセージ入力モーダル -->
    <div class="custom-message-modal" id="customMessageModal">
        <div class="modal-content">
            <span class="close-btn" id="closeCustomMessage">&times;</span>
            <h2 id="customMessageTitle">お誕生日メッセージを入力</h2>
            <textarea id="customMessageInput" placeholder="メッセージを入力してください..." maxlength="200"></textarea>
            <button id="submitCustomMessage">メッセージを送る</button>
        </div>
    </div>

    <!-- ミュージックプレイヤー -->
    <div class="music-player">
        <button class="music-control" id="playMusic">▶️</button>
        <span class="song-title">ハッピーバースデーソング</span>
    </div>

    <!-- メモリーウォールモーダル -->
    <div class="memory-wall" id="memoryWall">
        <div class="album-controls">
            <div class="search-box">
                <input type="text" id="searchTags" placeholder="タグで検索...">
            </div>
            <button id="slideshowBtn" class="feature-button">▶️ スライドショー</button>
        </div>
        <div class="photo-gallery" id="photoGallery"></div>
        <div class="swiper-container" id="slideshowContainer">
            <div class="swiper-wrapper" id="slideshowWrapper"></div>
            <div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>
            <div class="swiper-pagination"></div>
            <div class="slideshow-controls">
                <button id="closeSlideshow">スライドショーを閉じる</button>
            </div>
        </div>
    </div>

    <div class="balloon-container" id="balloonContainer">
        <!-- バルーンはJavaScriptで動的に追加されます -->
    </div>
    
    <div class="container">
        <h1 id="birthdayTitle" class="birthday-title" style="display: none;">お誕生日おめでとう</h1>
        
        <div class="countdown" id="countdown">
            <p>誕生日まであと<span id="days">0</span>日<span id="hours">0</span>時間<span id="minutes">0</span>分<span id="seconds">0</span>秒！</p>
        </div>
        
        <div id="birthdayContent" class="hidden">
            <div class="cake-container" style="display: none;">
                <!-- 3Dケーキはここにjavascriptで追加されます -->
            </div>
            
            <div class="cake-2d-container">
                <div class="cake-2d">
                    <div class="cake-tier cake-tier-1">
                        <div class="cake-decoration cake-decoration-1"></div>
                        <div class="cake-decoration cake-decoration-2"></div>
                        <div class="cake-decoration cake-decoration-3"></div>
                        <div class="cake-decoration cake-decoration-4"></div>
                        <div class="cake-decoration cake-decoration-5"></div>
                    </div>
                    <div class="cake-tier cake-tier-2"></div>
                    <div class="cake-tier cake-tier-3">
                        <div class="candle candle-1">
                            <div class="flame"></div>
                        </div>
                        <div class="candle candle-2">
                            <div class="flame"></div>
                        </div>
                        <div class="candle candle-3">
                            <div class="flame"></div>
                        </div>
                        <div class="candle candle-4">
                            <div class="flame"></div>
                        </div>
                        <div class="candle candle-5">
                            <div class="flame"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <button id="micPermissionBtn">マイクの使用を許可する</button>
            <button id="blowButton">ろうそくを吹いて！</button>
            <canvas id="audioFeedback"></canvas>
            
            <div class="progress-container" id="progressContainer">
                <div id="blowProgress">0%</div>
            </div>
            
            <p class="message" id="birthdayMessage">
                お誕生日おめでとうございます！今日があなたにとって素敵な一日になりますように！
            </p>
            <div id="customMessageDisplay" class="custom-message-display"></div>
        </div>
    </div>

    <script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
    <script defer src="assets/js/supabase-config.js"></script>
    <script defer src="assets/js/core.js"></script>
    <script defer src="assets/js/themes.js"></script>
    <script defer src="assets/js/features.js"></script>
    <script defer src="assets/js/community.js"></script>
    <script defer src="assets/js/album.js"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script defer src="https://unpkg.com/swiper@8/swiper-bundle.min.js"></script>

    <!-- 動的に作成される画像の遅延読み込みヘルパー -->
    <script defer>
      document.addEventListener('DOMContentLoaded', () => {
        const ensureLazy = img => {
          if (!img.hasAttribute('loading')) img.setAttribute('loading', 'lazy')
        }
        document.querySelectorAll('img').forEach(ensureLazy)
        const observer = new MutationObserver(ms => {
          ms.forEach(m => {
            m.addedNodes.forEach(node => {
              if (node.nodeType === 1) {
                if (node.tagName === 'IMG') ensureLazy(node)
                node.querySelectorAll?.('img').forEach(ensureLazy)
              }
            })
          })
        })
        observer.observe(document.body, { childList: true, subtree: true })
      })
    </script>
    <link rel="stylesheet" href="https://unpkg.com/swiper@8/swiper-bundle.min.css" />
    <script>
        // テーマテスター JavaScript
        const themeNames = {
            spring: '春 (Spring)',
            summer: '夏 (Summer)', 
            autumn: '秋 (Autumn)',
            winter: '冬 (Winter)',
            hanami: '花見 (Hanami)',
            tanabata: '七夕 (Tanabata)',
            obon: 'お盆 (Obon)',
            tsukimi: '月見 (Tsukimi)',
            christmas: '🎄 (Christmas)',
            newyear: '🎊 (New Year)',
            valentine: '💕 (Valentine)',
            halloween: '🎃 (Halloween)',
            bunka: '文化の日 (Bunka)'
        };
        
        function testTheme(themeName) {
            console.log(`🎨 テーマをテスト中: ${themeName}`);
            
            // 現在のテーマ表示を更新
            const currentThemeEl = document.getElementById('current-theme');
            if (currentThemeEl) {
                currentThemeEl.textContent = themeNames[themeName] || themeName;
            }
            
            // 既存の関数を使用してテーマを適用
            if (window.applyTheme) {
                window.applyTheme(themeName);
            } else {
                console.warn('⚠️ applyTheme関数が見つかりません');
            }
        }
        
        function clearAllEffects() {
            console.log('🧹 すべてのテーマエフェクトをクリア中...');
            
            // テーマエフェクトをクリア
            const effects = document.querySelectorAll('.theme-effect, .falling-leaf');
            effects.forEach(effect => effect.remove());
            
            // 葉の落下インターバルをクリア
            if (window.leafFallIntervals) {
                window.leafFallIntervals.forEach(interval => clearInterval(interval));
                window.leafFallIntervals = [];
                console.log('🧹 葉の落下インターバルをクリアしました');
            }
            
            console.log(`🧹 ${effects.length}個のエフェクトを削除しました`);
        }
        
        // ページ読み込み時に初期化
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🎨 テーマテスターが初期化されました');
            
            // 初期テーマ表示を設定
            const currentThemeEl = document.getElementById('current-theme');
            if (currentThemeEl) {
                currentThemeEl.textContent = 'spring (春)';
            }
        });
    </script>

</body>
</html>